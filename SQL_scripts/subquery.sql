
--SINGLE VALUE
SELECT *
FROM EMPLOYEES
WHERE DEPARTMENT_ID= (
    SELECT DEPARTMENT_ID
    FROM DEPARTMENTS
    WHERE DEPARTMENT_NAME='Sales'
);

--EMPLOYEE_ID,FIRST_NAME,LAST_NAME,EMAIL,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,COMMISSION_PCT,MANAGER_ID,DEPARTMENT_ID
-- 145,John,Russell,JRUSSEL,011.44.1344.429268,01-OCT-04,SA_MAN,14000,0.4,100,80
-- 146,Karen,Partners,KPARTNER,011.44.1344.467268,05-JAN-05,SA_MAN,13500,0.3,100,80
-- 147,Alberto,Errazuriz,AERRAZUR,011.44.1344.429278,10-MAR-05,SA_MAN,12000,0.3,100,80..

--SINGLE ROW
SELECT *
FROM EMPLOYEES
WHERE (DEPARTMENT_ID,MANAGER_ID) = (
    SELECT DEPARTMENT_ID,MANAGER_ID
    FROM DEPARTMENTS
    WHERE DEPARTMENT_NAME='Sales' AND MANAGER_ID=145
);
--EMPLOYEE_ID,FIRST_NAME,LAST_NAME,EMAIL,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,COMMISSION_PCT,MANAGER_ID,DEPARTMENT_ID
-- 150,Peter,Tucker,PTUCKER,011.44.1344.129268,30-JAN-05,SA_REP,10000,0.3,145,80
-- 151,David,Bernstein,DBERNSTE,011.44.1344.345268,24-MAR-05,SA_REP,9500,0.25,145,80..

--multi row
SELECT *
FROM EMPLOYEES
WHERE DEPARTMENT_ID IN  (
    SELECT DEPARTMENT_ID
    FROM DEPARTMENTS
    WHERE DEPARTMENT_NAME='Sales' OR DEPARTMENT_NAME='Marketing'
);
SELECT *
FROM EMPLOYEES
WHERE DEPARTMENT_ID > ALL (
    SELECT DEPARTMENT_ID
    FROM DEPARTMENTS
    WHERE DEPARTMENT_NAME='Sales' OR DEPARTMENT_NAME='Marketing'
);
--EMPLOYEE_ID,FIRST_NAME,LAST_NAME,EMAIL,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,COMMISSION_PCT,MANAGER_ID,DEPARTMENT_ID
-- 201,Michael,Hartstein,MHARTSTE,515.123.5555,17-FEB-04,MK_MAN,13000,,100,20
-- 202,Pat,Fay,PFAY,603.123.6666,17-AUG-05,MK_REP,6000,,201,20
-- 145,John,Russell,JRUSSEL,011.44.1344.429268,01-OCT-04,SA_MAN,14000,0.4,100,80

--GIVES MAX SALARIED EMP WORKING IN SALES

SELECT *
FROM EMPLOYEES
WHERE SALARY=(
    SELECT MAX(SALARY)
    FROM EMPLOYEES
    WHERE DEPARTMENT_ID=(
        SELECT DEPARTMENT_ID
        FROM DEPARTMENTS
        WHERE DEPARTMENT_NAME='Sales'
    )
    GROUP BY DEPARTMENT_ID
);
--EMPLOYEE_ID,FIRST_NAME,LAST_NAME,EMAIL,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,COMMISSION_PCT,MANAGER_ID,DEPARTMENT_ID
-- 145,John,Russell,JRUSSEL,011.44.1344.429268,01-OCT-04,SA_MAN,14000,0.4,100,80

--GIVE MAX SALARY FOR EACH DEP
SELECT *
FROM EMPLOYEES MAINq
WHERE SALARY=(
    SELECT MAX(SALARY)
    FROM EMPLOYEES SUBq
    WHERE MAINq.DEPARTMENT_ID=SUBq.DEPARTMENT_ID
);
--EMPLOYEE_ID,FIRST_NAME,LAST_NAME,EMAIL,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,COMMISSION_PCT,MANAGER_ID,DEPARTMENT_ID
-- 100,Steven,King,SKING,515.123.4567,17-JUN-03,AD_PRES,24000,,,90
-- 103,Alexander,Hunold,AHUNOLD,590.423.4567,03-JAN-06,IT_PROG,9000,,102,60
-- 108,Nancy,Greenberg,NGREENBE,515.124.4569,17-AUG-02,FI_MGR,12008,,101,100
-- 114,Den,Raphaely,DRAPHEAL,515.127.4561,07-DEC-02,PU_MAN,11000,,100,30

--DISPLAY EMP WHOSE ID IS PRESENT IN MANAGER ID
SELECT EMPLOYEE_ID,FIRST_NAME,LAST_NAME
FROM EMPLOYEES
WHERE EMPLOYEE_ID IN (
    SELECT DISTINCT MANAGER_ID
    FROM EMPLOYEES
);

SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME
FROM EMPLOYEES MAINq
WHERE EMPLOYEE_ID IN (
    SELECT MANAGER_ID
    FROM EMPLOYEES SUBq
    WHERE MAINq.EMPLOYEE_ID=SUBq.MANAGER_ID
);
--EMPLOYEE_ID,FIRST_NAME,LAST_NAME
-- 100,Steven,King
-- 101,Neena,Kochhar
-- 102,Lex,De Haan
-- 103,Alexander,Hunold
-- 108,Nancy,Greenberg

SELECT EMPLOYEE_ID,FIRST_NAME,LAST_NAME
FROM EMPLOYEES MAINq
WHERE EXISTS (
    SELECT 'DISTINCT' MANAGER_ID
    FROM EMPLOYEES SUBq
    WHERE MAINq.EMPLOYEE_ID=SUBq.MANAGER_ID
);

--TO COMPARE ACT SALARY TO AVG SALARY
SELECT DEPARTMENT_ID,FIRST_NAME,LAST_NAME,SALARY,(
    SELECT ROUND(AVG(SALARY),2) 
    FROM EMPLOYEES SUBq
    WHERE MAINq.DEPARTMENT_ID=SUBq.DEPARTMENT_ID) AS AVERAGE_DEPT_SALARY
FROM EMPLOYEES MAINq;

--INLINE VIEWS
SELECT DISTINCT MAINq.DEPARTMENT_ID,FIRST_NAME, LAST_NAME
FROM (
        SELECT *
        FROM EMPLOYEES 
        WHERE SALARY>1000
     ) MAINq
    JOIN(
        SELECT * 
        FROM DEPARTMENTS
        WHERE DEPARTMENT_ID<20
        ) SUBq 
ON MAINq.DEPARTMENT_ID = SUBq.DEPARTMENT_ID;

--using CREATE TABLE COMMAND
CREATE TABLE DUP2 AS 
    SELECT * FROM REGIONS 
    WHERE REGION_ID IN (2,3);
SELECT * FROM DUPL2;

-- SUB QUERY IN UPDATE OR DELETE COMMANDS
INSERT INTO EMPLOY7 VALUES (
    200,'NOMAN','C',1000
);
INSERT INTO EMPLOY7 VALUES (
    300,'CROWMAN','B',4000
);
INSERT INTO EMPLOY7 VALUES (
    400,'BATWOMAN','A',6000
);

UPDATE EMPLOY7
SET SALARY=SALARY+500
WHERE SALARY< (
    SELECT AVG(SALARY)
    FROM EMPLOY7);
--ENO,ENAME,GRADE,SALARY
-- 100,FAISAL,A,12000
-- 200,NOMAN,C,1500
-- 300,CROWMAN,B,4500
-- 400,BATWOMAN,A,6000