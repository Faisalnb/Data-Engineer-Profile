-- 1. Create a table bills with the columns 
-- BILL_NO,CUST_NAME,BILL_DT,AMOUNT.
-- Insert the rows with the bill date 10 minutes back,1 hour back, one day 
-- back,one week back,two weeks back,one month back,two months back, 
-- 4 months back, one year back.
CREATE TABLE BILLS (
    BILL_NO NUMBER(3),CUST_NAME VARCHAR2(20),BILL_DT DATE,AMOUNT NUMBER(5)
);
INSERT INTO BILLS VALUES ('100','AAA',SYSDATE-10/24/60,1001);
INSERT INTO BILLS VALUES ('101','BBB',SYSDATE-1/24,1003);
INSERT INTO BILLS VALUES ('102','CCC',SYSDATE-1,1004);
INSERT INTO BILLS VALUES ('103','DDD',SYSDATE-7,1005);
INSERT INTO BILLS VALUES ('104','EEE',SYSDATE-2*7,1005);
INSERT INTO BILLS VALUES ('105','FFF',ADD_MONTHS(SYSDATE,-1),1006);
INSERT INTO BILLS VALUES ('106','GGG',ADD_MONTHS(SYSDATE,-2),1007);
INSERT INTO BILLS VALUES ('107','HHH',ADD_MONTHS(SYSDATE,-4),1008);
INSERT INTO BILLS VALUES ('108','III',ADD_MONTHS(SYSDATE,-12),1009);

SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS;

-- 2. Write a query to display todays bills
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT between  TIMESTAMP '2022-10-31 00:00:00' and TIMESTAMP '2022-10-31 23:59:00';

-- 3. Write a query to display bills within half an hour to current time
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT >  TIMESTAMP '2022-10-31 19:00:00';


-- 4. Write a query to display bills within last 3 hours to current time
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT >  TIMESTAMP '2022-10-31 16:33:00';


-- 5. Write a query to display bills of morning (before 12 pm today)
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-10-31 00:00:00' AND  TIMESTAMP '2022-10-31 00:00:00';


-- 6. Write a query to display bills of 10 am to 11 pm
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-10-31 10:00:00' AND  TIMESTAMP '2022-10-31 23:00:00';


-- 7. Write a query to display bills of yester day
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-10-30 00:00:00' AND TIMESTAMP '2022-10-31 00:00:00';

-----
-- 8. Write a query to display bills of this week
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-10-24 00:00:00' AND TIMESTAMP '2022-10-30 23:59:00';

-- 9. Write a query to display bills of last week
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-10-17 00:00:00' AND TIMESTAMP '2022-10-23 23:59:00';

-- 10.Write a query to display bills of first week of this month
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-10-01 00:00:00' AND TIMESTAMP '2022-10-09 23:59:00';

-- 11.Write a query to display bills of last month
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-09-01 00:00:00' AND TIMESTAMP '2022-09-30 23:59:00';

-- 12.Write a query to display bills of last month last day
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT between  TIMESTAMP '2022-09-30 00:00:00' and TIMESTAMP '2022-10-30 23:59:00';

-- 13.Write a query to display bills of last month last three days
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-09-28 00:00:00' AND TIMESTAMP '2022-09-30 23:59:00';

-- 14.Write a query to display bills of last two months
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-08-01 00:00:00' AND TIMESTAMP '2022-09-30 23:59:00';

-- 15.Write a query to display bills of this quarter
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT > TIMESTAMP '2022-10-01 00:00:00';

-- 16.Write a query to display bills of last quarter
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-07-01 00:00:00' AND TIMESTAMP '2022-09-30 23:59:00';

-- 17.Write a query to display bills of this year
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2022-01-01 00:00:00' AND TIMESTAMP '2022-12-31 23:59:00';

-- 18.Write a query to display bills of last year
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT BETWEEN TIMESTAMP '2021-01-01 00:00:00' AND TIMESTAMP '2021-12-31 23:59:00';


-- 19.Write a query to display bills of last year last month
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT between  timestamp '2021-12-01 00:00:00' and timestamp '2021-12-31 23:59:00';


DROP TABLE BILLS;

SELECT TO_TIMESTAMP('2007-03-01 07:00:00')  FROM DUAL;

--write a query to extract bills of 31st oct
SELECT BILL_NO,CUST_NAME,TO_CHAR(BILL_DT,'DD-MON-YYYY HH:MI:SS AM') AS BILL_DATE,AMOUNT
FROM BILLS
WHERE BILL_DT > TIMESTAMP '2022-10-31 00:00:00';

